---
layout: post
title: 강화학습 시리즈1_의사결정을 위한 MDP 기초, 정책, 가치함수
category: 강화학습
tag: RL
---

## MDP 기초

강화학습의 가장 기본이 되는 두 가지 요소는 에이전트와 환경입니다. 그리고 그 둘은 서로 행동과 상태, 보상을 주고 받습니다. 이를 도식화한 그림은 아래와 같습니다.

<a href="https://imgur.com/63OlhGq"><img src="https://imgur.com/63OlhGq.png" width="700px" title="source: imgur.com" /></a>

강화학습은 시퀀셜하게 연속되는 스텝의 반복입니다. 아래 항목은 그 하나의 스텝을 나타냅니다.

매 시점 $t$마다,
- 에이전트는 현재 상태 $s_t$를 관측
- 에이전트는 $s_t$를 이용하여 적합한 행동 $a_t$를 구하여 환경에 인가
- 환경은 행동 $a_t$를 반영
- 환경은 행동 $a_t$에 의해 변경된 다음 상태 $s_{t+1}$ 및 보상 $r_{t+1}$를 에이전트에 인가

강화학습을 처음 접하신 분들은 새로 듣게 되는 단어가 많으실 것 같은데요, 앞서 언급된 각 요소에 대해서 설명드리도록 하겠습니다.

- 에이전트: 관측과 행동의 주체
- 환경: 해결해야 하는 문제 혹은 그 문제가 일어나는 공간
- 상태: 환경의 현재 상황을 잘 표현하는 관측값
- 행동: 에이전트가 환경의 현재 상황을 보고 추론한 다음 상태의 행동
- 보상: 하나의 숫자로 표현된 행동에 대한 평가지표

위 요소는 강화학습이라는 도메인에서 가장 중요한 개념입니다. 하지만 딥러닝이나 다른 도메인에 계셨던 분들은 처음 들었을 거라 생소할 것이라 생각하는데요, 이 개념들은 시리즈에서 계속 언급되니 지금 눈에 들어오지 않더라도 크게 걱정하실 필요는 없습니다.

## 마르코프 특성

"어떤 문제가 마르코프하다"라는 말을 들어보신 적 있으신가요? 어떤 시퀀스의 조건부 확률밀도함수가 아래와 같으면 마르코프 시퀀스라고 합니다.

$P(s_{t+1}|s_t, s_{t-1}, ..., s_0, a_t, a_{t-1}, ..., a_0) = P(s_{t+1}|s_t, a_t)$

식을 풀이하자면 과거의 상태와 과거의 행동은 필요 없이 현재의 상태와 현재의 행동 정보만 있으면 다음 상태를 알 수 있다는 말입니다. 이해가 어려우신 분들을 위해 5가지 예시를 통해 설명드리겠습니다.

질문: 다음 상황은 마르코프한가요?
1. 자동차를 운전한다.
2. 주어진 주식에 투자할 것인지 결정한다.
3. 축구 경기에서 어느 팀이 이길지 예측한다.
4. 어떤 목적지로의 최단 경로를 선택한다.
5. 평궁삼거리의 교통신호를 제어한다.

정답은 다음과 같습니다!
1. 마르코프합니다. 자동차를 운전하는 운전자는 핸들을 꺾꺼나 액셀/브레이크를 밟기 위해 과거 궤적을 알 필요가 없습니다.
2. 마르코프하지 않습니다. 과거의 시퀀셜한 데이터를 기반으로 미래의 주식 동향을 예측한 뒤 투자를 결정하기 때문입니다.
3. 마르코프하지 않습니다. 과거의 승률을 분석하여 예측하기 때문입니다.
4. 마르코프합니다. 최단 경로는 현재 주어진 도로의 geometry만 있으면 구할 수 있기 때문입니다.
5. 마르코프합니다. 현재 도로의 상태 정보만 있으면 제어할 수 있고, 그 도로가 한 시간 전에 막혔는지 안 막혔는지는 중요하지 않습니다.

## 마르코프 과정

다음으로 마르코프 과정에 대해 알아보겠습니다. 마르코프 과정은 상태 S와 상태 천이 행렬 P로 이루어진 튜플입니다.

<a href="https://imgur.com/a/42Go4WU"><img src="https://imgur.com/a/42Go4WU.png" width="300px" title="source: imgur.com" /></a>

S는 앞서 설명한대로 현재 상태입니다. P는 상태 천이 행렬인데 뒤에서 추가적으로 알아보겠습니다. 우선 S에 집중하겠습니다. 아래 그림과 같이 간단한 예시를 들어보겠습니다. 평궁삼거리의 교통신호를 강화학습으로 제어하기 위해서 평궁삼거리의 상태를 파악하고자 합니다. 이 때, 3개 진입로의 정체 여부를 각각 소통 원활과 정체로 나누면 평궁삼거리의 상태는 총 8개로 나타낼 수 있습니다. 

<a href="https://imgur.com/mv2LBUa"><img src="https://imgur.com/mv2LBUa.png" height="200px" title="source: imgur.com" />

<a href="https://imgur.com/1sF0p1e"><img src="https://imgur.com/1sF0p1e.png" height="200px" title="source: imgur.com" /></a>

